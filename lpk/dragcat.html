<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="author" content="智能社 - zhinengshe.com">
<meta name="copyright" content="智能社 - zhinengshe.com">
<title>智能社 - www.zhinengshe.com</title>
<link rel="stylesheet" type="text/css" href="css/global.css">
<style type="text/css">
#box{width: 546px;height: 546px;margin:auto;border:1px solid #000;margin-top: 80px;}
#box li{margin: 10px;width: 160px;height: 160px;float: left;}
#box li img{height: 160px;width: 160px;}
#box .on{border:3px dashed red;width: 154px;height: 154px;}
#box .on img{width: 154px;height: 154px;}
#box span{width:160px;height: 160px;position: absolute;top:0;left:0;background:rgba(255,255,255,0.5);text-align: center;line-height: 160px;font-size: 50px;}
</style>
<script type="text/javascript" src='js/move.js'></script>
<script type="text/javascript">
window.onload=function(){
	var oUl=document.getElementById('box');
	var aLi=oUl.getElementsByTagName('li');
	var aPos=[];
	var zIndex=1;
	for(var i=0;i<aLi.length;i++){
		aPos.push({top:aLi[i].offsetTop,left:aLi[i].offsetLeft});
	}
	for(var i=0;i<aLi.length;i++){
		aLi[i].style.top=aPos[i].top+'px';
		aLi[i].style.left=aPos[i].left+'px';
		aLi[i].style.position='absolute';
		aLi[i].style.margin=0;
		aLi[i].index=i;
		//var oSpan=document.createElement('span');
		//oSpan.innerHTML=i;
		//aLi[i].appendChild(oSpan);
	}
	for(var i=0;i<aLi.length;i++){
		drag(aLi[i]);
	}
	function drag(obj){
		obj.onmousedown=function(ev){
			var oEvent=ev||event;
			var disX=oEvent.clientX-obj.offsetLeft;
			var disY=oEvent.clientY-obj.offsetTop;
			zIndex++;
			obj.style.zIndex=zIndex;
			var oNear=null;
			//alert(disY);
			document.onmousemove=function(ev){
				var oEvent=ev||event;
				obj.style.top=oEvent.clientY-disY+'px';
				obj.style.left=oEvent.clientX-disX+'px';
				oNear=findNear(obj);
				console.log(oNear);
				for(var i=0;i<aLi.length;i++){
						aLi[i].className='';
					}

				if(oNear){
					oNear.className='on';
				}
			};
			document.onmouseup=function(){
				document.onmousemove=null;
				document.onmouseup=null;
				oNear=findNear(obj);
				if(oNear){
					move(oNear,aPos[obj.index]);
					move(obj,aPos[oNear.index]);
					//oNear.style.left=aPos[obj.index].left+'px';
					//oNear.style.top=aPos[obj.index].top+'px';
					//obj.style.left=aPos[oNear.index].left+'px';
					//obj.style.top=aPos[oNear.index].top+'px';
					var tmp=obj.index;
					obj.index=oNear.index;
					oNear.index=tmp;
					oNear.className='';
				}else{
					move(obj,aPos[obj.index]);
					//obj.style.left=aPos[obj.index].left+'px';
					//obj.style.top=aPos[obj.index].top+'px';					
				}
			};
			return false;
		};
	}
	function findNear(obj){
		var nMin=9999999999;
		var nMinIndex=-1;
		for(var i=0;i<aLi.length;i++){
			if(obj==aLi[i]){
				continue;
			}else{
				if(collText(obj,aLi[i])){
					var dis=getdis(obj,aLi[i]);
					if(dis<nMin){
						nMin=dis;
						nMinIndex=i;
					}
				}
			}
		}
		return aLi[nMinIndex];
	}
	function collText(obj1,obj2){
		var l1=obj1.offsetLeft;
		var r1=l1+obj1.offsetWidth;
		var t1=obj1.offsetTop;
		var b1=t1+obj1.offsetHeight;
		var l2=obj2.offsetLeft;
		var r2=l2+obj2.offsetWidth;
		var t2=obj2.offsetTop;
		var b2=obj2.offsetHeight+t2;
		if(r1<l2||b1<t2||l1>r2||t1>b2){
			return false;
		}else{
			return true;
		};
	}
	function getdis(obj1,obj2){
		var a=obj1.offsetLeft+obj1.offsetWidth/2-(obj2.offsetLeft+obj2.offsetWidth/2);
		var b=obj1.offsetTop+obj1.offsetHeight/2-(obj2.offsetTop+obj2.offsetHeight/2);
		var c=a*a+b*b;
		return c;
	};
}
</script>
</head>
<body>
<div id="nav">
	<div class="wrap">
		<ul>
			<li><a href="index.html">首&nbsp;&nbsp;&nbsp;&nbsp;页</a></li>
			<li style="padding: 18px 0px 0px 600px;"><img src="images/qiuzhi.gif"></li>
			<li class="tel">TEL:15810992376</li>
		</ul>
	</div>
</div>
<ul id="box">
	<li><img src="images/cat/1.jpg"></li>
	<li><img src="images/cat/2.jpg"></li>
	<li><img src="images/cat/3.jpg"></li>
	<li><img src="images/cat/4.jpg"></li>
	<li><img src="images/cat/5.jpg"></li>
	<li><img src="images/cat/6.jpg"></li>
	<li><img src="images/cat/7.jpg"></li>
	<li><img src="images/cat/8.jpg"></li>
	<li><img src="images/cat/9.jpg"></li>
</ul>
</body>
</html>











